<!DOCTYPE html>
<html>
    <head>
        <!-- Cache-Control Headers for preventing browser caching issues -->
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />

        <!-- pygbag placeholder for title, charset, viewport etc. -->
        {{PYGBAG_METAS}}

        <style>
            body, html {
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-color: #000;
            }
            /* pygbagが生成するcanvasを画面にフィットさせるためのスタイル */
            canvas#canvas { 
                position: absolute;
                width: 100%;
                height: 100%;
                object-fit: contain; /* Keep aspect ratio */
            }

            /* --- ローディングインジケーターのスタイル --- */
            #loading-indicator {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: #42a5f5; /* pygbagのロード画面の色 */
                color: white;
                font-family: sans-serif;
                font-size: 1.2em;
                z-index: 9999;
                transition: opacity 0.5s ease; /* フェードアウト用 */
            }
            .spinner {
                border: 8px solid rgba(255, 255, 255, 0.3);
                border-top: 8px solid #ffffff;
                border-radius: 50%;
                width: 60px;
                height: 60px;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>
    <body>
        <!-- 最初から表示されるローディング画面 -->
        <div id="loading-indicator">
            <div class="spinner"></div>
            <p>Loading Game...</p>
        </div>

        <!-- pygbagがゲーム本体をここに挿入します -->
        {{PYGBAG_SCRIPTS}}

        <script>
            // pygbagがcanvasを生成するのを待ってローディング画面を非表示にする
            document.addEventListener('DOMContentLoaded', () => {
                const intervalId = setInterval(() => {
                    if (document.getElementById('canvas')) {
                        clearInterval(intervalId);
                        const indicator = document.getElementById('loading-indicator');
                        if (indicator) {
                            indicator.style.opacity = '0';
                            setTimeout(() => indicator.remove(), 500); // 0.5秒後にフェードアウトして要素を削除
                        }
                    }
                }, 100); // 0.1秒ごとにチェック
            });
        </script>
    </body>
</html>
